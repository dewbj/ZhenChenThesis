//*Batch result setting (updated)
call apoc.periodic.iterate('match (p:Test_I1) where not exists(p.Res20) return p.uuid as id','match (p:Test_I1) where p.uuid = id with p.HPO_Term_Name as list, p.uuid as id, p.DisorderName as di match (h:HPO)<-[r:Phenotype]-(d:Disease) where h.HPO_Term_Name in list with d.DisorderName as Disease, count(distinct h) as Count, collect(h.HPO_Term_Name) as MHPOs, d.NDPR as NDPR, id, di match (h:HPO) where h.HPO_Term_Name in MHPOs with distinct Disease, Count, NDPR, MHPOs as `Matched HPOs`, sum(h.NPDR) as SumNPDR, case Disease when di then 1 else 0 end as Result, id, di as Answer order by Count desc, NDPR, SumNPDR limit 20 with collect(Result) as Res20, id match (p:Test_I1 {uuid:id}) set p.Res20 = Res20', {batchSize:1,parallel:False})